<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ordena la Historia de la IA</title>
  <style>
    :root{
      --bg1:#0f1021; --bg2:#1b1f3b; --ac1:#7c5cff; --ac2:#00e5ff; --ok:#00d27a; --err:#ff4d6d; --glass: rgba(255,255,255,.08);
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:#eaf2ff; background: radial-gradient(1200px 800px at 20% 10%, #152046 0%, #0f1021 45%),
                  radial-gradient(900px 900px at 90% 30%, #0a3b52 0%, #0f1021 50%);
      overflow-x:hidden;
    }
    .grid-bg{position:fixed; inset:0; pointer-events:none; opacity:.25; background-image: linear-gradient(to right, rgba(255,255,255,.08) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,.08) 1px, transparent 1px); background-size: 40px 40px; mask-image: radial-gradient(900px 600px at 70% -10%, black 0%, transparent 70%);}    
    .container{max-width:1200px; margin:0 auto; padding:32px 20px 80px;}
    header{display:flex; align-items:center; gap:16px; flex-wrap:wrap; justify-content:space-between; margin-bottom:18px;}
    .title{display:flex; align-items:center; gap:14px;}
    .logo{width:44px; height:44px; border-radius:12px; background: conic-gradient(from 210deg at 50% 50%, var(--ac1), var(--ac2)); box-shadow: 0 0 0 6px rgba(124,92,255,.15), 0 8px 32px rgba(0,0,0,.35); animation: spin 8s linear infinite;}
    @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
    h1{font-size: clamp(22px, 3vw, 34px); margin:0; letter-spacing:.3px}
    .meta{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .chip{padding:8px 12px; border-radius:999px; backdrop-filter: blur(8px); background:var(--glass); border:1px solid rgba(255,255,255,.12); font-weight:600}
    .timer{font-variant-numeric: tabular-nums; font-size:20px}

    .panel{position:relative; background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.12); border-radius:22px; padding:22px; box-shadow: 0 18px 40px rgba(0,0,0,.35); overflow:hidden;}
    .panel::after{content:""; position:absolute; inset: -80px auto auto -80px; width:200px; height:200px; border-radius:50%; background: radial-gradient(closest-side, rgba(124,92,255,.35), transparent); filter: blur(20px); opacity:.6; pointer-events:none;}

    .instructions{opacity:.9; line-height:1.5; margin-bottom:14px}

    /* Nueva disposici√≥n: timeline en S (izquierda) + bloques (derecha) */
    .layout{display:grid; grid-template-columns: 1fr minmax(280px, 360px); gap:18px; align-items:start}
    @media(max-width:900px){ .layout{ grid-template-columns: 1fr; } }

    .timeline-wrap{position:relative;}
    .timeline{
      position:relative; background:rgba(12,16,40,.5); border:1px solid rgba(255,255,255,.12); border-radius:22px; padding:18px; min-height:540px; overflow:visible;
    }
    /* Path decorativo */
    .timeline svg{position:absolute; inset:0; width:100%; height:100%; pointer-events:none;}
    .slots{position:relative; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); grid-template-rows: repeat(5, 1fr); gap:18px; min-height:520px;}
    .slot{position:relative; border:2px dashed rgba(255,255,255,.35); background:rgba(255,255,255,.02); border-radius:16px; min-height:80px; display:flex; align-items:center; justify-content:center; padding:10px; transition: background .15s ease, transform .12s ease, border-color .15s ease;}
    .slot.highlight{background:rgba(0,229,255,.08); border-color:var(--ac2); transform: translateY(-2px);}
    .slot .num{position:absolute; top:8px; left:10px; font-weight:900; font-size:14px; opacity:.85; background:linear-gradient(135deg,var(--ac2),var(--ac1)); -webkit-background-clip:text; background-clip:text; color:transparent;}

    .pool{background:rgba(12,16,40,.5); border:1px solid rgba(255,255,255,.12); border-radius:22px; padding:16px;}
    .pool h3{margin:0 0 10px 0}
    .pool-list{display:grid; gap:12px;}

    .card{position:relative; background:rgba(12,16,40,.6); border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:12px 14px; min-height:56px; display:flex; align-items:center; gap:10px; cursor:grab; user-select:none; transition: transform .18s ease, box-shadow .18s ease, background .2s ease; box-shadow: 0 10px 24px rgba(0,0,0,.25)}
    .card:active{cursor:grabbing}
    .card:hover{transform: translateY(-2px); box-shadow:0 16px 36px rgba(0,0,0,.35)}

    .controls{display:flex; gap:10px; flex-wrap:wrap; margin-top:16px}
    .btn{appearance:none; border:none; font-weight:800; letter-spacing:.3px; padding:12px 16px; border-radius:14px; color:#0b0f1c; background:linear-gradient(135deg, var(--ac2), var(--ac1)); box-shadow: 0 8px 18px rgba(0,0,0,.35); cursor:pointer; transition: transform .12s ease, filter .12s ease;}
    .btn:hover{transform: translateY(-1px)}
    .btn:active{transform: translateY(1px)}
    .btn.alt{background:transparent; color:#eaf2ff; border:1px solid rgba(255,255,255,.18)}

    .status{margin-top:10px; font-weight:700}
    .status.ok{color:var(--ok)}
    .status.err{color:var(--err)}

    .modal-backdrop{position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; z-index:40}
    .modal{width:min(520px, 92vw); background:#10132a; color:#eaf2ff; border-radius:22px; border:1px solid rgba(255,255,255,.14); box-shadow:0 18px 60px rgba(0,0,0,.6); padding:22px}
    .modal h2{margin:0 0 10px 0}
    .modal p{opacity:.9}

    canvas#confetti{position:fixed; inset:0; pointer-events:none; z-index:50}
  </style>
</head>
<body>
  <div class="grid-bg"></div>
  <canvas id="confetti"></canvas>

  <div class="container">
    <header>
      <div class="title">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Ordena la historia de la Inteligencia Artificial</h1>
          <div class="sub">Arrastra cada bloque a la <strong>l√≠nea de tiempo en S</strong> (1 ‚Üí 10).</div>
        </div>
      </div>
      <div class="meta">
        <div class="chip"><span class="timer" id="timer">00:00.0</span></div>
        <div class="chip" id="best">Mejor tiempo: ‚Äî</div>
      </div>
    </header>

    <section class="panel layout">
      <!-- Timeline en S -->
      <div class="timeline-wrap">
        <div class="timeline">
          <!-- Path decorativo con SVG para sugerir direcci√≥n temporal -->
          <svg id="sPath" aria-hidden="true"></svg>
          <div class="slots" id="slots"></div>
          <div class="controls">
            <button class="btn alt" id="clearBtn">Vaciar l√≠nea</button>
            <button class="btn alt" id="shuffleBtn">Mezclar bloques</button>
            <button class="btn" id="checkBtn">Comprobar</button>
          </div>
          <div class="status" id="status"></div>
        </div>
      </div>

      <!-- Pool de bloques -->
      <aside class="pool">
        <h3>Bloques</h3>
        <div class="pool-list" id="pool"></div>
      </aside>
    </section>
  </div>

  <div class="modal-backdrop" id="winBackdrop" role="dialog" aria-modal="true" aria-labelledby="winTitle">
    <div class="modal">
      <h2 id="winTitle">¬°Orden correcto! üèÜ</h2>
      <p id="winText">Tiempo: <strong>00:00.0</strong></p>
      <div class="controls" style="margin-top:8px">
        <button class="btn" id="playAgain">Volver a jugar</button>
        <button class="btn alt" id="closeModal">Cerrar</button>
      </div>
    </div>
  </div>

<script>
(() => {
  // === Datos en el orden correcto ===
  const correctOrder = [
    "Conferencia Dartmouth",
    "Perceptr√≥n",
    "Redes neuronales",
    "Deep Blue",
    "IBM Watson",
    "AlphaGo",
    "Transformers",
    "GPT",
    "ChatGPT",
    "Gemini"
  ];

  // Refs UI
  const pool = document.getElementById('pool');
  const slotsWrap = document.getElementById('slots');
  const timerEl = document.getElementById('timer');
  const bestEl = document.getElementById('best');
  const statusEl = document.getElementById('status');
  const checkBtn = document.getElementById('checkBtn');
  const clearBtn = document.getElementById('clearBtn');
  const shuffleBtn = document.getElementById('shuffleBtn');
  const winBackdrop = document.getElementById('winBackdrop');
  const winText = document.getElementById('winText');
  const playAgain = document.getElementById('playAgain');
  const closeModal = document.getElementById('closeModal');

  // Timer
  let startTime = null, tickRaf = null, running = false, startedOnce = false;
  function startTimer(){
    if(running) return; running = true; if(!startedOnce){ startTime = performance.now(); startedOnce = true; }
    const loop = (t)=>{ if(!running) return; const d=t-startTime; timerEl.textContent = fmtTime(d); tickRaf = requestAnimationFrame(loop); };
    tickRaf = requestAnimationFrame(loop);
  }
  function stopTimer(){ running=false; if(tickRaf) cancelAnimationFrame(tickRaf); }
  function resetTimer(){ stopTimer(); startedOnce=false; timerEl.textContent = '00:00.0'; }
  function fmtTime(ms){
    const total = Math.floor(ms);
    const m = Math.floor(total/60000), s = Math.floor((total%60000)/1000), ds = Math.floor((total%1000)/100);
    return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}.${ds}`;
  }
  const BEST_KEY = 'ia-order-best';
  function loadBest(){ const b=localStorage.getItem(BEST_KEY); bestEl.textContent = 'Mejor tiempo: ' + (b? b : '‚Äî'); }
  function saveBest(ms){ const current = localStorage.getItem(BEST_KEY); if(!current || toMs(current) > ms){ localStorage.setItem(BEST_KEY, fmtTime(ms)); loadBest(); }}
  function toMs(str){ const [mm, rest] = str.split(':'); const [ss, d] = rest.split('.'); return (+mm)*60000 + (+ss)*1000 + (+d)*100; }

  // Construir slots en S (5 filas x 2 columnas), con n√∫meros 1..10
  function buildSlots(){
    slotsWrap.innerHTML = '';
    for(let i=0;i<10;i++){
      const row = Math.floor(i/2); // 0..4
      const isOddRow = row % 2 === 1; // serpiente
      const col = isOddRow ? (i%2===0? 2:1) : (i%2)+1; // 1 o 2
      const slot = document.createElement('div');
      slot.className = 'slot';
      slot.dataset.index = i; // 0..9
      slot.style.gridRow = (row+1);
      slot.style.gridColumn = col;
      slot.innerHTML = `<span class="num">${i+1}</span>`;
      makeDropTarget(slot);
      slotsWrap.appendChild(slot);
    }
    // dibujar la S pasando por el centro de cada slot en orden 1..10
    requestAnimationFrame(drawSPath);
  }

  // Construir pool de bloques (barajados)
  function buildPool(items){
    pool.innerHTML = '';
    items.forEach((label, idx)=>{
      const card = document.createElement('div');
      card.className = 'card';
      card.draggable = true; card.id = `card-${idx}`; card.dataset.label = label;
      card.textContent = label;
      card.addEventListener('dragstart', onDragStart);
      pool.appendChild(card);
    });
    makeDropTarget(pool, true); // permitir soltar para devolver al pool
  }

  function shuffle(arr){ const a=[...arr]; for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }

  // Drag helpers
  let draggingId = null;
  function onDragStart(e){
    draggingId = e.target.id;
    if(e.dataTransfer){ e.dataTransfer.setData('text/plain', draggingId); e.dataTransfer.effectAllowed='move'; }
    startTimer();
  }

  function makeDropTarget(el, isPool=false){
    el.addEventListener('dragover', (e)=>{ e.preventDefault(); el.classList.add('highlight'); if(e.dataTransfer) e.dataTransfer.dropEffect='move'; });
    el.addEventListener('dragleave', ()=> el.classList.remove('highlight'));
    el.addEventListener('drop', (e)=>{
      e.preventDefault(); el.classList.remove('highlight');
      const id = (e.dataTransfer && e.dataTransfer.getData('text/plain')) || draggingId; if(!id) return;
      const card = document.getElementById(id); if(!card) return;
      // Si el destino es un slot y ya tiene algo, lo devuelve al pool
      if(el.classList.contains('slot') && el.firstElementChild && el.querySelector('.card')){
        pool.appendChild(el.querySelector('.card'));
      }
      // Si el destino es pool, solo ap√©ndalo
      el.appendChild(card);
      refreshNumbers();
    });
  }

  function refreshNumbers(){ /* placeholder por si queremos renumerar algo visual */ }

  function getSlotsState(){
    const arr = Array.from(slotsWrap.children).map(slot=>{
      const c = slot.querySelector('.card'); return c? c.dataset.label : null;
    });
    return arr; // array de 10 con labels o null
  }

  function isCorrect(){
    const state = getSlotsState();
    if(state.some(v=>v===null)) return false; // deben estar todos llenos
    return state.every((v,i)=> v === correctOrder[i]);
  }

  function setStatus(msg, ok=false){ statusEl.textContent = msg; statusEl.className = 'status ' + (ok? 'ok':'err'); }

  function celebrate(){
    const canvas = document.getElementById('confetti'); const ctx = canvas.getContext('2d');
    let W = canvas.width = innerWidth, H = canvas.height = innerHeight;
    const pieces = Array.from({length: 220}, ()=>({ x: Math.random()*W, y: -20 - Math.random()*H, s: 4+Math.random()*6, vy: 2+Math.random()*4, vx: (Math.random()-.5)*2, r: Math.random()*Math.PI }));
    let animId; function draw(){ ctx.clearRect(0,0,W,H); pieces.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; p.r+=0.03; if(p.y>H+30){ p.y=-20; p.x=Math.random()*W; } ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.r); ctx.fillStyle = `hsl(${(p.x/W)*360},100%,60%)`; ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s); ctx.restore(); }); animId = requestAnimationFrame(draw); }
    function onResize(){ W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
    window.addEventListener('resize', onResize); draw(); setTimeout(()=>{ cancelAnimationFrame(animId); ctx.clearRect(0,0,W,H); window.removeEventListener('resize', onResize); }, 4000);
  }

  function openWinModal(timeStr){ winText.innerHTML = `Tiempo: <strong>${timeStr}</strong>`; winBackdrop.style.display = 'flex'; }
  function closeWinModal(){ winBackdrop.style.display = 'none'; }

  function startGame(){
    buildSlots();
    buildPool(shuffle(correctOrder));
    setStatus('Arrastra los bloques a las posiciones 1 ‚Üí 10.');
    resetTimer();
    requestAnimationFrame(drawSPath);
  }

  // Botones
  checkBtn.addEventListener('click', ()=>{
    if(isCorrect()){
      stopTimer(); const elapsed = performance.now() - startTime; const tStr = fmtTime(elapsed);
      setStatus('¬°Correcto! üéâ', true); saveBest(elapsed); celebrate(); openWinModal(tStr);
    } else {
      setStatus('A√∫n no es el orden correcto o hay espacios vac√≠os.', false);
      if(navigator.vibrate) navigator.vibrate(60);
    }
  });
  clearBtn.addEventListener('click', ()=>{
    // Devuelve todas las cartas al pool
    Array.from(slotsWrap.querySelectorAll('.slot .card')).forEach(c=> pool.appendChild(c));
    setStatus('L√≠nea vaciada.');
  });
  shuffleBtn.addEventListener('click', ()=>{
    // Baraja solo lo que est√© en el pool
    const cards = Array.from(pool.querySelectorAll('.card'));
    const labels = cards.map(c=>c.dataset.label);
    buildPool(shuffle(labels));
    setStatus('Bloques mezclados.');
  });

  playAgain.addEventListener('click', ()=>{ closeWinModal(); startGame(); });
  closeModal.addEventListener('click', closeWinModal);
  winBackdrop.addEventListener('click', (e)=>{ if(e.target===winBackdrop) closeWinModal(); });

  // === Autotests m√≠nimos (URL con #test) ===
  function runTests(){
    console.log('%c‚ñ∂ Ejecutando tests‚Ä¶','color:#00e5ff');
    const ok = [];
    // Test 1: orden correcto pasa
    startGame();
    // simula colocar todas las cartas en orden
    correctOrder.forEach((label, i)=>{
      const card = Array.from(pool.children).find(c=>c.dataset.label===label);
      const slot = slotsWrap.children[i];
      slot.appendChild(card);
    });
    const t1 = isCorrect();
    ok.push(['Orden correcto pasa', t1]);

    // Test 2: un intercambio debe fallar
    startGame();
    correctOrder.forEach((label, i)=>{
      const card = Array.from(pool.children).find(c=>c.dataset.label===label);
      const slot = slotsWrap.children[i];
      slot.appendChild(card);
    });
    const s0 = slotsWrap.children[0]; const s1 = slotsWrap.children[1];
    s0.appendChild(s1.querySelector('.card'));
    const t2 = !isCorrect();
    ok.push(['Orden incorrecto falla', t2]);

    // Test 3: slots numerados 1..10
    buildSlots();
    const nums = Array.from(slotsWrap.children).map((s, i)=> s.querySelector('.num')?.textContent === String(i+1));
    const t3 = nums.every(Boolean);
    ok.push(['Slots numerados 1..10', t3]);

    // Test 4: isCorrect false con huecos
    startGame();
    // coloca solo 9
    for(let i=0;i<9;i++){
      const label = correctOrder[i];
      const card = Array.from(pool.children).find(c=>c.dataset.label===label);
      const slot = slotsWrap.children[i];
      slot.appendChild(card);
    }
    const t4 = !isCorrect();
    ok.push(['isCorrect false con espacios vac√≠os', t4]);

    const all = ok.every(([_,v])=>v===true);
    ok.forEach(([name,v])=> console.log(`${v?'‚úÖ':'‚ùå'} ${name}`));
    console.log(all? '%cTodos los tests pasaron':'%cAlgunos tests fallaron','font-weight:bold;color:'+(all?'#00d27a':'#ff4d6d'));
  }

  // ===== Dibujo din√°mico de la S =====
  const svg = document.getElementById('sPath');
  function drawSPath(){
    if(!svg) return;
    const timeline = document.querySelector('.timeline');
    const rect = timeline.getBoundingClientRect();
    const width = Math.max(100, rect.width);
    const height = Math.max(100, rect.height);
    svg.setAttribute('width', width);
    svg.setAttribute('height', height);
    svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
    svg.style.position = 'absolute';
    svg.style.inset = '0';
    svg.style.pointerEvents = 'none';

    const slots = Array.from(slotsWrap.children);
    if(slots.length !== 10) return;

    // puntos en el centro de cada slot (en orden 1..10)
    const points = slots.map(slot=>{
      const b = slot.getBoundingClientRect();
      const cx = (b.left + b.right)/2 - rect.left;
      const cy = (b.top + b.bottom)/2 - rect.top;
      return {x: cx, y: cy};
    });

    // crea un path que pasa exactamente por los centros; suavizado ligero con Q
    const d = buildCatmullRomPath(points, 0.8);

    // limpiar svg
    while(svg.firstChild) svg.removeChild(svg.firstChild);

    const defs = document.createElementNS('http://www.w3.org/2000/svg','defs');
    const marker = document.createElementNS('http://www.w3.org/2000/svg','marker');
    marker.setAttribute('id','arrow');
    marker.setAttribute('markerWidth','10');
    marker.setAttribute('markerHeight','10');
    marker.setAttribute('refX','8');
    marker.setAttribute('refY','5');
    marker.setAttribute('orient','auto');
    const poly = document.createElementNS('http://www.w3.org/2000/svg','polygon');
    poly.setAttribute('points','0 0, 10 5, 0 10');
    poly.setAttribute('fill','rgba(0,229,255,.8)');
    marker.appendChild(poly);
    defs.appendChild(marker);
    svg.appendChild(defs);

    const path = document.createElementNS('http://www.w3.org/2000/svg','path');
    path.setAttribute('id','timelinePath');
    path.setAttribute('d', d);
    path.setAttribute('fill','none');
    path.setAttribute('stroke','rgba(124,92,255,.55)');
    path.setAttribute('stroke-width','4');
    path.setAttribute('stroke-linecap','round');
    path.setAttribute('stroke-linejoin','round');
    path.setAttribute('marker-end','url(#arrow)');
    svg.appendChild(path);

    // Animaci√≥n: punto que recorre la S
    const dot = document.createElementNS('http://www.w3.org/2000/svg','circle');
    dot.setAttribute('r','5');
    dot.setAttribute('fill','rgba(0,229,255,.9)');
    const anim = document.createElementNS('http://www.w3.org/2000/svg','animateMotion');
    anim.setAttribute('dur','6s');
    anim.setAttribute('repeatCount','indefinite');
    anim.setAttribute('rotate','auto');
    const mpath = document.createElementNS('http://www.w3.org/2000/svg','mpath');
    mpath.setAttributeNS('http://www.w3.org/1999/xlink','href','#timelinePath');
    anim.appendChild(mpath);
    dot.appendChild(anim);
    svg.appendChild(dot);
  }

  function buildCatmullRomPath(pts, t=0.6){
    if(!pts || pts.length===0) return '';
    if(pts.length===1) return `M ${pts[0].x} ${pts[0].y}`;
    const p = pts.map(pt=>({x:pt.x, y:pt.y}));
    let d = `M ${p[0].x} ${p[0].y}`;
    for(let i=0;i<p.length-1;i++){
      const p0 = p[i-1] || p[i];
      const p1 = p[i];
      const p2 = p[i+1];
      const p3 = p[i+2] || p[i+1];
      // Control points (uniform Catmull-Rom -> Bezier)
      const cp1x = p1.x + (p2.x - p0.x) / 6 * t;
      const cp1y = p1.y + (p2.y - p0.y) / 6 * t;
      const cp2x = p2.x - (p3.x - p1.x) / 6 * t;
      const cp2y = p2.y - (p3.y - p1.y) / 6 * t;
      d += ` C ${cp1x} ${cp1y}, ${cp2x} ${cp2y}, ${p2.x} ${p2.y}`;
    }
    return d;
  }

  // Redibujar al cambiar layout/resize
  let resizeRaf;
  window.addEventListener('resize', ()=>{ cancelAnimationFrame(resizeRaf); resizeRaf = requestAnimationFrame(drawSPath); });

  // Bootstrap
  loadBest();
  startGame();
  if(location.hash.replace('#','').toLowerCase()==='test') runTests();
})();
</script>
</body>
</html>






